<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500" width="900" height="500">
  <!-- Title -->
  <text x="450" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#1f2937">
    Standard vs Robust LOWESS
  </text>
  
  <!-- Left panel: Standard LOWESS (no robustness) -->
  <g id="standard-panel">
    <!-- Panel title -->
    <text x="225" y="65" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#374151">
      Standard LOWESS (0 iterations)
    </text>
    <text x="225" y="85" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#6b7280" font-style="italic">
      Curve pulled toward outliers
    </text>
    
    <!-- Axes -->
    <line x1="50" y1="420" x2="400" y2="420" stroke="#374151" stroke-width="2"/>
    <line x1="50" y1="420" x2="50" y2="100" stroke="#374151" stroke-width="2"/>
    
    <!-- Grid lines -->
    <line x1="50" y1="340" x2="400" y2="340" stroke="#e5e7eb" stroke-width="1"/>
    <line x1="50" y1="260" x2="400" y2="260" stroke="#e5e7eb" stroke-width="1"/>
    <line x1="50" y1="180" x2="400" y2="180" stroke="#e5e7eb" stroke-width="1"/>
    
    <!-- Standard LOWESS curve (smooth but moderately distorted by outliers) -->
    <path d="M 70,400 C 110,385 150,365 175,310 C 200,280 240,270 270,250 C 300,235 340,220 370,200" 
          fill="none" stroke="#dc2626" stroke-width="3" stroke-linecap="round"/>
    
    <!-- Data points (good points in blue) -->
    <circle cx="70" cy="395" r="5" fill="#2563eb"/>
    <circle cx="100" cy="385" r="5" fill="#2563eb"/>
    <circle cx="130" cy="370" r="5" fill="#2563eb"/>
    <circle cx="160" cy="355" r="5" fill="#2563eb"/>
    <circle cx="190" cy="335" r="5" fill="#2563eb"/>
    <circle cx="220" cy="315" r="5" fill="#2563eb"/>
    <circle cx="250" cy="295" r="5" fill="#2563eb"/>
    <circle cx="280" cy="275" r="5" fill="#2563eb"/>
    <circle cx="310" cy="255" r="5" fill="#2563eb"/>
    <circle cx="340" cy="235" r="5" fill="#2563eb"/>
    <circle cx="370" cy="215" r="5" fill="#2563eb"/>
    
    <!-- Outliers (in red with larger size) -->
    <circle cx="175" cy="200" r="7" fill="#ef4444" stroke="#dc2626" stroke-width="2"/>
    <circle cx="270" cy="180" r="7" fill="#ef4444" stroke="#dc2626" stroke-width="2"/>
    
    <!-- Outlier labels -->
    <text x="175" y="185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#dc2626" font-weight="bold">
      outlier
    </text>
    <text x="270" y="165" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#dc2626" font-weight="bold">
      outlier
    </text>
    
    <!-- Axis labels -->
    <text x="400" y="440" font-family="Arial, sans-serif" font-size="14" fill="#374151">x</text>
    <text x="35" y="95" font-family="Arial, sans-serif" font-size="14" fill="#374151">y</text>
  </g>
  
  <!-- Right panel: Robust LOWESS -->
  <g id="robust-panel">
    <!-- Panel title -->
    <text x="675" y="65" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#374151">
      Robust LOWESS (3 iterations)
    </text>
    <text x="675" y="85" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#059669" font-style="italic">
      Outliers downweighted, curve stable
    </text>
    
    <!-- Axes -->
    <line x1="500" y1="420" x2="850" y2="420" stroke="#374151" stroke-width="2"/>
    <line x1="500" y1="420" x2="500" y2="100" stroke="#374151" stroke-width="2"/>
    
    <!-- Grid lines -->
    <line x1="500" y1="340" x2="850" y2="340" stroke="#e5e7eb" stroke-width="1"/>
    <line x1="500" y1="260" x2="850" y2="260" stroke="#e5e7eb" stroke-width="1"/>
    <line x1="500" y1="180" x2="850" y2="180" stroke="#e5e7eb" stroke-width="1"/>
    
    <!-- Robust LOWESS curve (smooth, ignores outliers) -->
    <path d="M 520,400 C 560,385 600,365 640,340 C 680,315 720,285 760,260 C 790,245 810,225 820,200" 
          fill="none" stroke="#059669" stroke-width="3" stroke-linecap="round"/>
    
    <!-- Data points (good points in blue) -->
    <circle cx="520" cy="395" r="5" fill="#2563eb"/>
    <circle cx="550" cy="385" r="5" fill="#2563eb"/>
    <circle cx="580" cy="370" r="5" fill="#2563eb"/>
    <circle cx="610" cy="355" r="5" fill="#2563eb"/>
    <circle cx="640" cy="335" r="5" fill="#2563eb"/>
    <circle cx="670" cy="315" r="5" fill="#2563eb"/>
    <circle cx="700" cy="295" r="5" fill="#2563eb"/>
    <circle cx="730" cy="275" r="5" fill="#2563eb"/>
    <circle cx="760" cy="255" r="5" fill="#2563eb"/>
    <circle cx="790" cy="235" r="5" fill="#2563eb"/>
    <circle cx="820" cy="215" r="5" fill="#2563eb"/>
    
    <!-- Outliers (grayed out to show they're downweighted) -->
    <circle cx="625" cy="200" r="7" fill="#d1d5db" stroke="#9ca3af" stroke-width="2" opacity="0.6"/>
    <circle cx="720" cy="180" r="7" fill="#d1d5db" stroke="#9ca3af" stroke-width="2" opacity="0.6"/>
    
    <!-- Cross marks on outliers to show they're ignored -->
    <line x1="620" y1="195" x2="630" y2="205" stroke="#6b7280" stroke-width="2"/>
    <line x1="630" y1="195" x2="620" y2="205" stroke="#6b7280" stroke-width="2"/>
    <line x1="715" y1="175" x2="725" y2="185" stroke="#6b7280" stroke-width="2"/>
    <line x1="725" y1="175" x2="715" y2="185" stroke="#6b7280" stroke-width="2"/>
    
    <!-- Outlier labels -->
    <text x="625" y="185" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#6b7280" font-style="italic">
      ignored
    </text>
    <text x="720" y="165" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#6b7280" font-style="italic">
      ignored
    </text>
    
    <!-- Axis labels -->
    <text x="850" y="440" font-family="Arial, sans-serif" font-size="14" fill="#374151">x</text>
    <text x="485" y="95" font-family="Arial, sans-serif" font-size="14" fill="#374151">y</text>
  </g>
  
  <!-- Legend -->
  <g transform="translate(350, 455)">
    <rect x="0" y="0" width="200" height="35" fill="white" stroke="#d1d5db" stroke-width="1" rx="5"/>
    
    <!-- Good data points -->
    <circle cx="15" cy="12" r="5" fill="#2563eb"/>
    <text x="25" y="17" font-family="Arial, sans-serif" font-size="12" fill="#374151">Data points</text>
    
    <!-- Outliers -->
    <circle cx="115" cy="12" r="6" fill="#ef4444" stroke="#dc2626" stroke-width="1.5"/>
    <text x="125" y="17" font-family="Arial, sans-serif" font-size="12" fill="#374151">Outliers</text>
  </g>
  
  <!-- Comparison arrow -->
  <g transform="translate(425, 250)">
    <line x1="0" y1="0" x2="50" y2="0" stroke="#6b7280" stroke-width="2" marker-end="url(#arrow)"/>
    <text x="25" y="-10" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#059669" font-weight="bold">
      Robustness
    </text>
  </g>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6b7280"/>
    </marker>
  </defs>
</svg>
