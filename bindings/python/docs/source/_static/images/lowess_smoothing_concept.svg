<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600" width="800" height="600">
  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#1f2937">
    LOWESS: Locally Weighted Smoothing
  </text>
  
  <!-- Axes -->
  <line x1="80" y1="520" x2="720" y2="520" stroke="#374151" stroke-width="2"/>
  <line x1="80" y1="520" x2="80" y2="80" stroke="#374151" stroke-width="2"/>
  
  <!-- Axis labels -->
  <text x="720" y="545" font-family="Arial, sans-serif" font-size="16" fill="#374151">x</text>
  <text x="60" y="75" font-family="Arial, sans-serif" font-size="16" fill="#374151">y</text>
  
  <!-- Grid lines (light) -->
  <line x1="80" y1="420" x2="720" y2="420" stroke="#e5e7eb" stroke-width="1"/>
  <line x1="80" y1="320" x2="720" y2="320" stroke="#e5e7eb" stroke-width="1"/>
  <line x1="80" y1="220" x2="720" y2="220" stroke="#e5e7eb" stroke-width="1"/>
  <line x1="80" y1="120" x2="720" y2="120" stroke="#e5e7eb" stroke-width="1"/>
  
  <!-- Local neighborhood highlight (semi-transparent ellipse) -->
  <ellipse cx="400" cy="280" rx="120" ry="100" fill="#3b82f6" fill-opacity="0.15" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- LOWESS smooth curve (red) -->
  <path d="M 100,480 Q 200,450 300,380 T 500,240 T 700,140" 
        fill="none" stroke="#dc2626" stroke-width="3" stroke-linecap="round"/>
  
  <!-- Data points (blue circles with some noise) -->
  <circle cx="100" cy="485" r="6" fill="#2563eb"/>
  <circle cx="140" cy="465" r="6" fill="#2563eb"/>
  <circle cx="180" cy="455" r="6" fill="#2563eb"/>
  <circle cx="220" cy="430" r="6" fill="#2563eb"/>
  <circle cx="260" cy="410" r="6" fill="#2563eb"/>
  <circle cx="300" cy="385" r="6" fill="#2563eb"/>
  <circle cx="340" cy="350" r="6" fill="#2563eb"/>
  <circle cx="380" cy="315" r="6" fill="#2563eb"/>
  <circle cx="420" cy="275" r="6" fill="#2563eb"/>
  <circle cx="460" cy="250" r="6" fill="#2563eb"/>
  <circle cx="500" cy="235" r="6" fill="#2563eb"/>
  <circle cx="540" cy="210" r="6" fill="#2563eb"/>
  <circle cx="580" cy="185" r="6" fill="#2563eb"/>
  <circle cx="620" cy="165" r="6" fill="#2563eb"/>
  <circle cx="660" cy="150" r="6" fill="#2563eb"/>
  <circle cx="700" cy="145" r="6" fill="#2563eb"/>
  
  <!-- Highlight the center point in the local window -->
  <circle cx="420" cy="275" r="8" fill="#dc2626" stroke="#fff" stroke-width="2"/>
  
  <!-- Dotted lines showing local weighting (from center to nearby points) -->
  <line x1="420" y1="275" x2="340" y2="350" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.6"/>
  <line x1="420" y1="275" x2="380" y2="315" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.6"/>
  <line x1="420" y1="275" x2="460" y2="250" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.6"/>
  <line x1="420" y1="275" x2="500" y2="235" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.6"/>
  
  <!-- Legend -->
  <g transform="translate(550, 400)">
    <rect x="0" y="0" width="200" height="100" fill="white" stroke="#d1d5db" stroke-width="1" rx="5"/>
    
    <!-- Data points legend -->
    <circle cx="15" cy="20" r="6" fill="#2563eb"/>
    <text x="30" y="25" font-family="Arial, sans-serif" font-size="14" fill="#374151">Data points</text>
    
    <!-- LOWESS curve legend -->
    <line x1="10" y1="45" x2="25" y2="45" stroke="#dc2626" stroke-width="3"/>
    <text x="30" y="50" font-family="Arial, sans-serif" font-size="14" fill="#374151">LOWESS curve</text>
    
    <!-- Local window legend -->
    <ellipse cx="17" cy="75" rx="12" ry="8" fill="#3b82f6" fill-opacity="0.15" stroke="#3b82f6" stroke-width="1.5" stroke-dasharray="3,3"/>
    <text x="30" y="80" font-family="Arial, sans-serif" font-size="14" fill="#374151">Local window</text>
  </g>
  
  <!-- Annotation arrow and text -->
  <path d="M 320,200 L 380,250" stroke="#6b7280" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <text x="250" y="190" font-family="Arial, sans-serif" font-size="13" fill="#6b7280" font-style="italic">
    Nearby points weighted
  </text>
  <text x="250" y="208" font-family="Arial, sans-serif" font-size="13" fill="#6b7280" font-style="italic">
    by distance
  </text>
  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6b7280"/>
    </marker>
  </defs>
</svg>
